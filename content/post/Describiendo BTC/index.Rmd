---
output: hugodown::md_document
# Documentation: https://sourcethemes.com/academic/docs/managing-content/

title: "Describiendo Bitcoin - I"
subtitle: ""
summary: "Analizaremos con la ayuda de la estad√≠stica descriptiva los movimientos de una criptomoneda"
authors: [admin]
tags: [Probabilidad, Estadistica, Criptomoneda]
categories: []
date: 2022-05-10
lastmod: 2022-05-10
featured: false
draft: false

# Featured image
# To use, add an image named `featured.jpg/png` to your page's folder.
# Focal points: Smart, Center, TopLeft, Top, TopRight, Left, Right, BottomLeft, Bottom, BottomRight.
image:
  caption: "Photo by [www.bolsamania.com](https://www.bolsamania.com/noticias/criptodivisas/el-bitcoin-corrige-un-10-fin-del-rally-o-toma-de-beneficios--8277113.html)"
  focal_point: "smart"
  preview_only: false
  placement: 1
  
# Custom links (optional).
#   Uncomment and edit lines below to show custom links.
links:
- icon: linkedin
  icon_pack: fab
  name: Follow
  url: https://www.linkedin.com/in/morialva27/

# Projects (optional).
#   Associate this post with one or more of your projects.
#   Simply enter your project's folder or file name without extension.
#   E.g. `projects = ["internal-project"]` references `content/project/deep-learning/index.md`.
#   Otherwise, set `projects = []`.
projects: []
---
<div style="text-align: justify">

Bitcoin (BTC en adelante por sus siglas) es una moneda digital creada en el 2008 por una entidad bajo el pseudonimo de Satoshi Nakamoto, que sirve de intercambio como otra moneda f√≠sica. La caracter√≠stica m√°s resaltante es que es una moneda descentralizada, es decir no existe una autoridad o ente de control que sea responsable de su emisi√≥n y registro de sus movimientos y adem√°s esta blindada contra la inflaci√≥n, ya que existe un numero l√≠mite de monedas. La tecnolog√≠a que usa para la transferencia o movimientos de la moneda digital es la cadena de bloques o Blockchain, la cual en t√©rminos simples lleva un registro de cada movimiento o etiqueta, y se copia en cada cadena de bloques de manera que todos los usuarios de la cadena deben tener la misma informaci√≥n para validar la transacci√≥n, lo que hace muy dif√≠cil la falsificaci√≥n. Si quieres saber m√°s te dejo informaci√≥n [aqu√≠](https://es.wikipedia.org/wiki/Bitcoin)

# **Leer informaci√≥n desde (CSV)**
```{r, message=FALSE, collapse=TRUE}
library(tidyverse)

btc <- read.csv("dailyDataBTC-USD.csv", stringsAsFactors = F, header = T)
btc <- btc %>% mutate(fecha = as.Date(as.POSIXct(unix, origin = "1970-01-01"))) %>% arrange(fecha)
min(btc$fecha)
max(btc$fecha)
max(btc$fecha)-min(btc$fecha)

```

Para fines pr√°cticos usaremos este [archivo](https://www.dmorialva.com/post/describiendo-btc/dailyDataBTC-USD.csv) para el an√°lisis. Pero te dejar√© un [link](https://www.dmorialva.com/post/describiendo-btc/funciones.R) para que puedas extraer informacion desde la una API.

Como un primer an√°lisis, mostraremos la serie temporal del bitcoin con su precio ajustado al cierre diario.

```{r, message=FALSE, eval=TRUE, collapse=TRUE}
library(ggplot2)

btc_graph <- btc %>%
            ggplot( aes(x=fecha, y=close)) +
            geom_line(color="#69b3a7") +
            ylab("Bitcoin ($)") 
btc_graph 

```

A partir del gr√°fico, solo podemos observar que el precio en este lapso de tiempo, form√≥ un soporte alrededor de los 30 mil y un m√°ximo de 65 mil. Ahora mencionaremos 2 conceptos b√°sicos para empezar a analizar el bitcoin y cualquier otro instrumento burs√°til.

# **Rendimiento o Retorno Simple y continuo**

Al iniciar a estudiar los modelos de finanzas cuantitativas b√°sicos, como obtener el riesgo hist√≥rico de un activo, o al intentar aplicar el modelo de Markowitz para un portafolio de inversi√≥n, necesitamos la variable retorno del activo. Para esto existen modelos que usan el rendimiento simple o aritm√©tico y otros el compuesto o logar√≠tmico. Pero ¬øCu√°ndo usar uno u otro? ¬øSon iguales o diferentes? Intentar√© poner sobre la mesa las ventajas y los usos de cada uno.

**Aritm√©tico o Simple**
----------------------
  Se calcula como la variaci√≥n porcentual de 2 precios en distintos momentos:
  $$Rs = \frac{P_t - P_{t-1}}{P_{t-1}}$$
  Esta forma del c√°lculo de los retornos hace que se encuentren normalizados, es decir son             comparables con otra serie de retornos de otro activo a pesar de que las magnitudes de sus precios sean considerablemente diferentes. Esto tambi√©n debe usarse para el c√°lculo de la matriz de covarianzas en nuestros an√°lisis, a fin de poder diversificar una cartera con el modelo de Markowitz. La rentabilidad acumulada de un periodo de tiempo es la media geom√©trica de las rentabilidades que lo componen.
  $$R_{acumulada} = \sqrt[N]{\prod_{i=1}^{N}Rs_i}$$
  Mas adelante este ser√° un punto en contra para el retorno simple.

  
**Logar√≠tmico o Continuo**
----------------------
  Se calcula como la diferencia de los precios en logaritmos naturales:
  $$Rc = \ln{(\frac{P_t}{P_{t-1}})}$$
  De la f√≥rmula de arriba es f√°cil deducir la siguiente relaci√≥n:
  $$Rc = \ln{(1+Rs)}$$
 La rentabilidad acumulada de un periodo de tiempo es la sumatoria de las rentabilidades que lo componen, gracias a las propiedades de los logaritmos.
  $$R_{acumulada} = \sum_{i=1}^{N}Rc_i = \sum_{i=1}^{N}ln{(1+Rs_i)}$$

  
En muchos modelos se asumen que la distribuci√≥n de los retornos de un activo sigue una distribuci√≥n normal, seg√∫n esto los retornos podr√≠an ir hasta valores de -$\infty$ y sabemos que la p√©rdida m√°xima es del 100% de la inversi√≥n. Otro problema de asumir esta distribuci√≥n es que constantemente estar√° a prueba la curtosis, que da la forma a las colas de la distribuci√≥n que en muchos casos ser√°n m√°s pesadas que una normal.
  
De este supuesto entonces se desprende que tanto el retorno simple y el continuo se distribuyen como una normal. En particular, al ser el retorno continuo el logaritmo de 1 + Rs, se dice que 1 + Rs se distribuye como una lognormal. Por los teoremas de convoluci√≥n, para el caso del retorno simple, el retorno acumulado es la productoria de variables aleatorias normales, cuyo resultado no se distribuye como una normal, mientras que, en el caso continuo, el retorno acumulado es hallado como la suma de variables normales cuyo resultado es una normal, mostr√°ndose as√≠ una gran ventaja sobre el simple.

# **Histograma de retornos BTC** 

Ahora vamos a empezar con un peque√±o an√°lisis de c√≥mo se comportan los rendimientos logar√≠tmicos diarios del BTC en el periodo de tiempo en estudio. Una manera simple de observarlo ser√≠a construir un histograma y obtener medidas que nos pueden ser muy informativas:

```{r, message=FALSE, echo=FALSE}
library(quantmod)

source("funciones.R")
names(btc)[5] <- "BTC"
output_btc <- histograma_variacion_log(btc,"BTC")
output_btc$plot

```

```{r, message=FALSE, echo=FALSE}
library(knitr)
kable(output_btc$r_r, booktabs = TRUE, align = "c", 
      col.names = c("Cripto","Retorno Esperado(%)","Volatilidad(%)"),format = "html")

kable(output_btc$VaR, booktabs = TRUE, align = "c", 
      col.names = c("M√©trica","Valor Retorno(%)"),format = "html")
```
Como sabemos, el histograma es la distribuci√≥n emp√≠rica de la variable aleatoria en estudio, en este caso son los retornos diarios del Bitcoin.  En esta vista podemos observar preferencias o acumulaciones en ciertos rangos representados por una barra de mayor altura, lo cual significa que con frecuencia los retornos se agrupan en esa √°rea y tambi√©n poder observar los m√≠nimos, m√°ximos y medidas de tendencia central, en particular la linea roja vertical representa el VaR al 95%. Pasaremos a explicar brevemente cada m√©trica descriptiva y para ello vamos a suponer que queremos tomar una posici√≥n en el mercado Spot con un capital de 100 USD, es decir comprar, mantener y luego vender.

**Probabilidad de ganar**
 $$P(Rc > 0) = \frac{Cuenta\ D√≠as\ Positivos}{Total\ D√≠as}$$
En el periodo analizado, en un d√≠a cualquiera existe un 52.84% de que sea un d√≠a con un retorno positivo.

**Retorno Promedio**
 $$\overline{Rc} = \frac{\sum_{i=1}^{N}{Rc_i}}{N}$$
Nos indica cual fue la rentabilidad diaria promedio en el periodo (0.27%).

**Retorno Positivo**
 $$\overline{Rc+} = \frac{\sum_{i=1}^{N+}{Rc_i+}}{Cuenta\ D√≠as\ Positivos}$$
Nos informa, que si el d√≠a en el que hemos abierto una posici√≥n de compra (posici√≥n Long), y √©ste resulta en un movimiento al alza, el retorno promedio esperado ser√≠a de 3.38%.

**Retorno Negativo**
 $$\overline{Rc-} = \frac{\sum_{i=1}^{N-}{Rc_i-}}{Cuenta\ D√≠as\ Negativos}$$
Al contrario del apartado anterior, si el d√≠a resulta en un movimiento a la baja, esperamos tener un retorno promedio de -3.21%.

**Volatilidad o Riesgo**
 $$\widehat {\sigma_R} = \sqrt\frac{\sum_{i=1}^{N}{(Rc_i-\overline{Rc})^{2}}}{N-1}$$
Esta medida de dispersi√≥n nos indica en cuanto se puede desviar la rentabilidad promedio esperada tanto positiva como negativamente, esto se le conoce como la volatilidad, que en este caso es de 4.43%. Piense en esta medida tambi√©n como el riesgo o incertidumbre debido a los movimientos del mercado.

**Valor en Riesgo o VaR No Param√©trico**
 $$VaR_{q} = quantil(1-q) = F_R^{-1}(1-q)  \ ;para\ q\in<0,1>$$
Otra medida de riesgo adicional a la de la volatilidad es la del VaR. Si el inversor est√° interesado en saber cu√°l es la m√°xima p√©rdida en un periodo con un nivel de confianza asociado, esta es la del VaR. Por ejemplo, en el caso en estudio el VaR(95%) es -6.46%, el cual indica que con un nivel de confianza del 95%, esperamos tener una perdida m√°xima en un d√≠a de 6.46% sobre la inversi√≥n. Otra manera intuitiva en este caso, pero que no se recomienda usar en el VaR no Param√©trico sin simulaciones de Montecarlo es tener como referencia un periodo de retorno, es decir con qu√© frecuencia se da el suceso de esta p√©rdida, en este caso es cada 20 d√≠as aproximadamente. Para llegar a este resultado es tomar la siguiente f√≥rmula:
 $$Periodo\ Retorno = \frac{1}{1-q} \ q\in<0,1>$$

**TVaR o CVaR**
 $$TVaR_{q} = E[R/R<=VaR_{q}]$$
Com√∫nmente conocido como Tail Value at Risk y tambi√©n como Conditional Value at risk(CVaR) o expected shortall es la p√©rdida esperada por una cartera en un periodo determinado mayor al umbral del VaR a un nivel de confianza. Esta medida de riesgo es muy usada en seguros y en el sistema financiero y en mucha de la bibliograf√≠a se considera que este cumple con las propiedades de una medida coherente (Denuit Michael, Dhaene Jan, Goovaerts Marc, Kaas Rob, ACTUARIAL THEORY
FOR DEPENDET RISKS, MEASURES, ORDERS AND MODELS, 2005). En este ejemplo, esta medida responde a la pregunta si en el peor de los casos se rompa el umbral de perdida m√°xima esperada (VaR), cuanto en promedio se esperar√≠a de p√©rdida en ese escenario, que para BTC ser√≠a de -9.8% Tvar95%.

Como mencionamos anteriormente, suponiendo que entramos en una posici√≥n de compra en el mercado spot y asumiendo que el periodo analizado es suficiente y representativo para esperar que √©sta se replique en el futuro, se esperar√≠a tener m√°s d√≠as al alza ya que este tiene una probabilidad del 52.84%, tambi√©n esperar√≠as tener un retorno promedio en el d√≠a de 0.27% de tu inversi√≥n, con una volatilidad de 4.43%, con una probabilidad m√°xima de perdida al 95% de 6.46% cada 20 d√≠as y con una perdida promedio esperada mayor al 6.46% de 9.80%. Esta informaci√≥n puede ser un punto de partida a considerar para poder compararlo con las mismas m√©tricas en otras criptomonedas y ver en cuales prefieras invertir. Si deseas tener una estrategia con mas de 1 criptomoneda a la vez, es importante que se cumpla la propiedad de subaditividad, que refleja la idea que el riesgo puede ser reducido por la diversificaci√≥n. No est√° dem√°s decir que este ejemplo es s√≥lo informativo y educativo y no es ning√∫n consejo de inversi√≥n. Espero haya podido despertar la curiosidad y que tengas un ejemplo de c√≥mo las probabilidades y la estad√≠stica est√°n incluida en estos temas.

<div>
### Te parece √∫til? Considera compartirlo üôå
